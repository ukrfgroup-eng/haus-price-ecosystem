# 🧠 АРХИТЕКТУРА MATRIX CORE - ДОМА-ЦЕНЫ.РФ

## 🌟 ОБЩАЯ СХЕМА СИСТЕМЫ
┌─────────────────────────────────────────────────────────────────┐
│ НЕЙРО-ЭКОСИСТЕМА СТРОИТЕЛЬСТВА │
│ ДОМА-ЦЕНЫ.РФ │
└─────────────────────────────────────────────────────────────────┘

text
                          ↓
┌─────────────────────────────────────────────────────────┐
│                   ИНТЕРФЕЙСНЫЙ СЛОЙ                     │
│  (ProTalk боты, Tilda, Flexbe - конструкторы)          │
└─────────────────────────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────────────────────────┐
│                   ШЛЮЗОВЫЙ СЛОЙ                         │
│  (Webhook API, REST API, Gateway)                       │
└─────────────────────────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────────────────────────┐
│                 КОГНИТИВНЫЙ СЛОЙ                        │
│              🧠 MATRIX CORE (Мозг)                      │
└─────────────────────────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────────────────────────┐
│                МОДУЛЬНЫЙ СЛОЙ                           │
│  AI-Партнер | AI-Подбор | AI-Рекомендации               │
└─────────────────────────────────────────────────────────┘
text

## 🔗 ИНТЕГРАЦИИ И КОНСТРУКТОРЫ

### ProTalk Боты (Основной канал коммуникации)
ProTalk Platform → Webhook → MATRIX CORE → Ответ → ProTalk Bot
↓ ↓ ↓ ↓ ↓
Пользователь Запрос Анализ и Форматир. Рекомендации
общается в JSON подбор ответа пользователю

text

**Ключевые особенности ProTalk интеграции:**
- 🤖 **Мульти-бот архитектура** - разные сценарии для разных аудиторий
- 🔄 **Real-time общение** - мгновенные ответы через вебхуки
- 🎯 **Контекстные сценарии** - адаптация под тип пользователя
- 📊 **Сбор данных** - профилирование через диалоги

### Другие конструкторы:
- **🌐 Flexbe** - Главная страница и лендинги
- **👤 Tilda** - Личные кабинеты и формы
- **📱 Будущие** - Мобильные приложения, Telegram боты

## 🏗️ ТЕХНИЧЕСКАЯ АРХИТЕКТУРА

### Backend структура:
backend/
├── 🧠 app.py # Основное приложение Flask
├── ⚙️ config.py # Конфигурация
├── 📊 routes/ # API маршруты
│ ├── analysis_routes.py # Анализ запросов
│ ├── partner_routes.py # Управление партнерами
│ ├── user_routes.py # Работа с пользователями
│ ├── connection_routes.py # Соединения
│ └── webhook_routes.py # Интеграции (ProTalk, Tilda, Flexbe)
├── 🗃️ models/ # Модели данных
│ ├── user_models.py # Пользователи и запросы
│ ├── partner_models.py # Партнеры и профили
│ └── analysis_models.py # Анализ и рекомендации
└── 🛠️ utils/ # Утилиты и AI-помощники
├── ai_helpers.py # Анализ намерений, подбор
├── data_helpers.py # Валидация, нормализация
└── webhook_helpers.py # Обработка вебхуков

text

### Frontend конструкторы:
frontend/
├── 🤖 umniko/ # ProTalk боты (сценарии диалогов)
├── 🌐 flexbe/ # Главная страница (лендинг)
└── 👤 tilda/ # Личный кабинет (дашборды)

text

## 🔄 ПОТОК ДАННЫХ В СИСТЕМЕ

### Основной workflow:
[ProTalk Bot] → Пользователь начинает диалог

[Webhook] → Запрос отправляется в MATRIX CORE

[AI Analyzer] → Анализ намерения и извлечение сущностей

[Partner Matcher] → Подбор релевантных партнеров

[Crisis Detection] → Учет срочности и доступности

[Response Builder] → Форматирование ответа

[ProTalk Bot] → Показ рекомендаций пользователю

[Connection Engine] → Создание связи при согласии

text

### Кризис-ориентированный workflow:
КРИЗИС СБЫТА → AI-ЭКОСИСТЕМА → АВТОМАТИЧЕСКИЕ ПРОДАЖИ
↓ ↓ ↓
Пустые склады MATRIX CORE Постоянный поток
Простаивающие анализирует целевых заказчиков
производства рынок в реальном ↓
Нет заказов времени Прямые контакты
↓ Без комиссий
Находит голодных Быстрее конкурентов
заказчиков

text

## 🎯 КЛЮЧЕВЫЕ КОМПОНЕНТЫ

### 1. MATRIX CORE (Центральный мозг)
- **Neural Orchestrator** - координация работы модулей
- **AI Analyzer** - анализ намерений пользователей
- **Partner Matcher** - интеллектуальный подбор
- **Crisis Detector** - выявление кризисных ситуаций

### 2. ProTalk Боты (Интерфейс)
- **Бот для заказчиков** - подбор подрядчиков
- **Бот для подрядчиков** - получение заказов  
- **Бот для производителей** - поиск партнеров

### 3. Модули данных
- **User Management** - пользователи и профили
- **Partner Registry** - база партнеров с верификацией
- **Connection Engine** - управление связями
- **Analytics** - сбор метрик и аналитика

## 🔧 ТЕХНОЛОГИЧЕСКИЙ СТЕК

### Backend:
- **🐍 Python 3.9+** - основной язык
- **🌶 Flask** - веб-фреймворк
- **🗄️ SQLite/PostgreSQL** - база данных
- **🤖 AI Libraries** - анализ текста, рекомендации

### Frontend (Конструкторы):
- **🤖 ProTalk** - диалоговые боты
- **🌐 Flexbe** - лендинг страницы
- **👤 Tilda** - личные кабинеты

### Инфраструктура:
- **🐳 Docker** - контейнеризация
- **🚀 Nginx** - веб-сервер
- **🔗 GitHub** - контроль версий

## 📊 МОДЕЛИ ДАННЫХ

### Основные сущности:
```python
# User - базовый пользователь
User(user_id, user_type, email, profile_data)

# UserRequest - запрос пользователя  
UserRequest(request_id, user_id, request_type, request_data)

# Partner - партнер (подрядчик/производитель)
Partner(partner_id, company_data, specializations, crisis_indicators)

# Connection - связь между пользователями
Connection(connection_id, from_user, to_user, context, status)
Кризисные показатели:
python
crisis_indicators = {
    'urgency_level': 0-10,           # Срочность заказов
    'available_capacity': 0-100,     # Свободные мощности
    'flexible_pricing': Boolean,     # Гибкость ценообразования
    'special_conditions': List       # Специальные условия
}
🌐 API ENDPOINTS
Основные группы:
text
/api/v1/
├── analyze/           # Анализ запросов
│   ├── POST /request         # Анализ пользовательского запроса
│   ├── POST /crisis-match    # Кризисный подбор
│   └── GET  /result/{id}     # Результаты анализа
├── partners/          # Управление партнерами
│   ├── POST /register        # Регистрация партнера
│   ├── POST /search          # Поиск партнеров
│   ├── GET  /crisis-board    # Доска кризисных партнеров
│   └── CRUD /{id}/profile    # Управление профилем
├── users/             # Работа с пользователями
│   ├── POST /register        # Регистрация
│   ├── POST /request         # Создание запроса
│   └── CRUD /{id}/profile    # Управление профилем
├── connect/           # Соединения
│   ├── POST /users           # Установление связи
│   └── PUT  /{id}/status     # Обновление статуса
└── webhooks/          # Интеграции
    ├── POST /umniko          # ProTalk боты
    ├── POST /tilda           # Tilda формы
    └── POST /flexbe          # Flexbe действия
🚀 ИНТЕГРАЦИЯ С PROTALK
Webhook формат для ProTalk:
python
# Входящий запрос от ProTalk:
{
    "user_id": "protalk_user_123",
    "message": "Ищу строителя каркасного дома в Москве до 3 млн",
    "user_data": {
        "user_type": "customer",
        "region": "Московская область",
        "previous_interactions": [...]
    },
    "session_id": "session_456",
    "timestamp": "2024-01-01T12:00:00Z"
}

# Исходящий ответ к ProTalk:
{
    "messages": [
        {
            "type": "text",
            "content": "Нашлось 5 подходящих подрядчиков...",
            "quick_replies": ["Показать варианты", "Уточнить запрос"]
        }
    ],
    "session_data": {
        "current_intent": "partner_search",
        "matched_partners": [...],
        "next_step": "show_recommendations"
    }
}
Сценарии ProTalk ботов:
👤 Для заказчиков - подбор подрядчиков по критериям

👷 Для подрядчиков - получение заявок и управление профилем

🏭 Для производителей - поиск партнеров среди подрядчиков

🎯 БИЗНЕС-ЛОГИКА
Кризис-ориентированные алгоритмы:
python
# Подбор с учетом кризисных показателей
def crisis_aware_matching(customer, partners):
    scores = []
    for partner in partners:
        score = (
            urgency_match(customer, partner) * 0.3 +
            capacity_match(partner) * 0.25 +
            specialization_match(customer, partner) * 0.2 +
            geo_match(customer, partner) * 0.15 +
            budget_match(customer, partner) * 0.1
        )
        scores.append((partner, score))
    return sorted(scores, key=lambda x: x[1], reverse=True)
Монетизация:
💰 Партнерские пакеты - доступ к экосистеме

🎯 Премиум-размещение - приоритет в рекомендациях

📊 Расширенная аналитика - детальная статистика

🔮 ПЕРСПЕКТИВЫ РАЗВИТИЯ
Ближайшие шаги:
Интеграция с реальной БД - PostgreSQL

Расширение AI-возможностей - машинное обучение

Мобильное приложение - React Native

Дополнительные интеграции - Telegram, WhatsApp

Стратегическое развитие:
Эмерджентный интеллект - самообучающаяся система

Децентрализованная архитектура - устойчивость и масштабируемость

Отраслевые стандарты - создание новых рынков

💡 ДЛЯ НОВЫХ РАЗРАБОТЧИКОВ
Быстрый старт:

bash
git clone https://github.com/doma-ceny/matrix-core-ecosystem.git
cd matrix-core-ecosystem
docker-compose up -d
Ключевые файлы для понимания:

backend/app.py - основное приложение

backend/routes/webhook_routes.py - интеграция с ProTalk

backend/utils/ai_helpers.py - AI-логика

docs/api.md - документация API

Тестирование интеграции:

bash
# Тест ProTalk вебхука
curl -X POST http://localhost:5000/webhook/umniko \
  -H "Content-Type: application/json" \
  -d '{"user_id": "test", "message": "Ищу строителя"}'
Архитектура MATRIX CORE - живой организм, который эволюционирует вместе с пользователями 🧠
